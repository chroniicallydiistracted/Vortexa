{"type": "schema", "version": "1.0", "description": "Machine-readable change history for WestFam-Weather-AWS. One JSON object per line. First line is the schema.", "fields": {"id": {"type": "string", "description": "Stable unique identifier for this change (UUID v4 recommended)."}, "timestamp": {"type": "string", "description": "UTC timestamp in RFC3339/ISO-8601 format."}, "actor": {"type": "string", "enum": ["copilot-agent", "human", "automation"], "description": "Who executed the change."}, "area": {"type": "string", "enum": ["web", "services/proxy", "services/alerts", "infra/terraform", "data", "docs", "ci"], "description": "Primary subsystem touched."}, "summary": {"type": "string", "description": "Short one-line summary of the change."}, "rationale": {"type": "string", "description": "Why the change was made (context/goal)."}, "vision_alignment_confirmed": {"type": "boolean", "description": "Agent explicitly confirmed relevance to VISION.md goals before acting."}, "pre_checks": {"type": "array", "items": "string", "description": "Pre-change checks and their status, e.g., 'build:pass', 'lint:pass', 'tests:n/a'."}, "changes": {"type": "array", "items": {"type": "object", "fields": {"path": {"type": "string", "description": "File or directory path relative to repo root."}, "action": {"type": "string", "enum": ["add", "modify", "delete", "rename"], "description": "Type of change."}, "diff_stats": {"type": "object", "fields": {"added": {"type": "integer"}, "removed": {"type": "integer"}}, "description": "Approximate line delta (omit if unknown)."}}}, "description": "List of concrete file-level changes."}, "commits": {"type": "array", "items": {"type": "object", "fields": {"sha": {"type": "string"}, "message": {"type": "string"}}}, "description": "Associated VCS commits, if available."}, "links": {"type": "object", "fields": {"pr": {"type": "string"}, "issue": {"type": "string"}}}, "post_checks": {"type": "array", "items": "string", "description": "Post-change validations and results."}, "risk": {"type": "string", "enum": ["low", "medium", "high"], "description": "Operational risk of the change."}, "impact": {"type": "string", "description": "User/system impact summary."}, "status": {"type": "string", "enum": ["proposed", "applied", "reverted"], "description": "Lifecycle state of the change."}, "follow_ups": {"type": "array", "items": "string", "description": "Actionable next steps created by this change."}, "tags": {"type": "array", "items": "string", "description": "Free-form labels."}}}
{"id": "9611660c-5bb2-4c06-a1ae-b2c16e2396c5", "timestamp": "2025-08-22T09:15:41Z", "actor": "copilot-agent", "area": "web", "summary": "Wrap app in TanStack Query provider; add demo GIBS GeoColor layer; type catalog fetch.", "rationale": "Enable async data fetching and provide a one-click satellite demo to validate the tile proxy end-to-end.", "vision_alignment_confirmed": true, "pre_checks": ["lint:pass", "build:pass", "tests:n/a"], "changes": [{"path": "web/src/main.tsx", "action": "modify", "diff_stats": {"added": 25, "removed": 5}}, {"path": "web/src/Panel.tsx", "action": "modify", "diff_stats": {"added": 60, "removed": 22}}, {"path": "web/.env.example", "action": "add", "diff_stats": {"added": 3, "removed": 0}}], "commits": [{"sha": "deadbeef1234", "message": "feat(web): add QueryClientProvider + demo GIBS layer"}], "links": {"pr": "", "issue": ""}, "post_checks": ["web:dev:ok", "proxy:dev:ok"], "risk": "low", "impact": "Developers can fetch and display live tiles via proxy; UX demo available.", "status": "applied", "follow_ups": ["Catalog: curate real WMTS layer IDs per provider", "Time slider: wire to GIBS time params"], "tags": ["frontend", "satellite", "proxy"]}
{"id": "8b12ab1b-a442-476a-8e2e-c77c3c69b8ab", "timestamp": "2025-08-22T09:15:41Z", "actor": "copilot-agent", "area": "infra/terraform", "summary": "Lock S3 public access, add CloudFront OAC, and bucket policy with SourceArn condition.", "rationale": "Ensure private S3 web bucket readable only via CloudFront, meeting AWS hardening guidance.", "vision_alignment_confirmed": true, "pre_checks": ["terraform:fmt:pass", "terraform:validate:pass", "plan:changes_detected"], "changes": [{"path": "infra/terraform/main.tf", "action": "modify", "diff_stats": {"added": 140, "removed": 30}}, {"path": "infra/terraform/terraform.tfvars", "action": "modify", "diff_stats": {"added": 6, "removed": 0}}], "commits": [{"sha": "beadfeed5678", "message": "infra: add OAC + S3 bucket policy; block public access"}], "links": {"pr": "", "issue": ""}, "post_checks": ["terraform:apply:ok", "cloudfront:deploy:in-progress"], "risk": "medium", "impact": "Public reads only through CloudFront; direct S3 access denied; reduces misconfig risk.", "status": "applied", "follow_ups": ["Route53: point weather.westfam.media to CloudFront", "ACM: attach cert to distribution"], "tags": ["security", "oac", "s3", "cloudfront"]}
{"id": "0b7c5ec3-6e0d-4e3f-9b22-8f6c0a0e3d11", "timestamp": "2025-08-22T12:00:00Z", "actor": "copilot-agent", "area": "infra/terraform", "summary": "Add domain/cert pairing validation + us-east-1 ACM ARN regex.", "rationale": "Prevent partial custom domain config and wrong-region certs early during validate.", "vision_alignment_confirmed": true, "pre_checks": ["terraform:validate:pending"], "changes": [{"path": "infra/terraform/main.tf", "action": "modify"}], "commits": [], "links": {}, "post_checks": [], "risk": "low", "impact": "Misconfiguration caught before plan/apply.", "status": "applied", "follow_ups": ["Run terraform plan with human approval"], "tags": ["validation", "cloudfront", "safety"]}
{"id": "5e9cfac0-2c2b-4b5f-9dc2-b8c4e6d0a9f4", "timestamp": "2025-08-22T12:00:05Z", "actor": "copilot-agent", "area": "services/alerts", "summary": "Deterministic Lambda packaging script with npm ci, prune, sorted zip, checksum.", "rationale": "Ensure reproducible minimal deployment artifact and integrity verification.", "vision_alignment_confirmed": true, "pre_checks": ["build:pending"], "changes": [{"path": "scripts/package-alerts.sh", "action": "modify"}], "commits": [], "links": {}, "post_checks": [], "risk": "low", "impact": "Smaller stable artifact with hash for promotion.", "status": "applied", "follow_ups": ["Add CI workflow to publish checksum", "Integrate hash check into deploy script"], "tags": ["packaging", "deterministic", "lambda"]}
{"id": "2f4c6d2a-d4b1-4f1e-a6c6-4d5e9b7f9e10", "timestamp": "2025-08-22T19:25:00Z", "actor": "copilot-agent", "area": "tests", "summary": "Refactor proxy to export createApp and add initial Vitest suites (proxy, alerts, shared).", "rationale": "Enable isolated testing and establish baseline automated coverage per instructions Testing Expectations.", "vision_alignment_confirmed": true, "pre_checks": ["build:pass"], "changes": [{"path": "services/proxy/src/index.ts", "action": "modify"}, {"path": "services/proxy/src/index.test.ts", "action": "add"}, {"path": "services/alerts/src/index.test.ts", "action": "add"}, {"path": "services/shared/src/types.test.ts", "action": "add"}, {"path": "services/proxy/package.json", "action": "modify"}, {"path": "services/alerts/package.json", "action": "modify"}, {"path": "services/shared/package.json", "action": "modify"}], "commits": [{"sha": "41a6a22", "message": "test: introduce vitest suites for proxy, alerts, and shared types; refactor proxy createApp"}], "links": {}, "post_checks": ["tests:pass"], "risk": "low", "impact": "Foundational test scaffolding reduces regression risk for future changes.", "status": "applied", "follow_ups": ["Add proxy URL normalization tests", "Add S3 cache tests", "Add alerts user-agent assertion"], "tags": ["tests", "refactor", "proxy", "alerts", "shared"]}
{"id": "6d3d29f2-1b7a-4c3c-9c6a-12f4f3a55e77", "timestamp": "2025-08-22T20:04:10Z", "actor": "copilot-agent", "area": "tests", "summary": "Add WMTS normalization & cache tests, alerts user-agent test, injectable S3 client, and CI test run + artifact upload.", "rationale": "Close documented testing gaps (URL normalization, cache hit/miss, User-Agent) and ensure CI enforces test suite.", "vision_alignment_confirmed": true, "pre_checks": ["build:pass"], "changes": [{"path": "services/proxy/src/index.ts", "action": "modify"}, {"path": "services/proxy/src/tiles.test.ts", "action": "add"}, {"path": "services/proxy/src/cache.test.ts", "action": "add"}, {"path": "services/alerts/src/index.test.ts", "action": "modify"}, {"path": ".github/workflows/ci.yml", "action": "modify"}], "commits": [{"sha": "3b78a80", "message": "[proxy][tests][ci] feat: add WMTS normalization & cache tests, user-agent test, injectable S3 client, run tests + upload artifact in CI"}], "links": {}, "post_checks": ["tests:pass"], "risk": "low", "impact": "Improved regression protection and CI visibility; safer future refactors.", "status": "applied", "follow_ups": ["Align history schema to new spec", "Add cost impact fields", "Add runbook docs"], "tags": ["tests", "ci", "proxy", "alerts"]}
